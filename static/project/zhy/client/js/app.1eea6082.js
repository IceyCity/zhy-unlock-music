(function(e){function t(t){for(var r,o,c=t[0],s=t[1],u=t[2],f=0,d=[];f<c.length;f++)o=c[f],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&d.push(i[o][0]),i[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);l&&l(t);while(d.length)d.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,c=1;c<n.length;c++){var s=n[c];0!==i[s]&&(r=!1)}r&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},i={app:0},a=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=s;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"08fe":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n("6367"),n("60d5"),n("e291");var r=function(){function e(t,n){if(void 0===n&&(n=e.numRounds),16!=t.length)throw Error("incorrect key size");if(0!=(1&n))throw Error("odd number of rounds specified");var r=new DataView(t.buffer);this.k0=r.getUint32(0,!1),this.k1=r.getUint32(4,!1),this.k2=r.getUint32(8,!1),this.k3=r.getUint32(12,!1),this.rounds=n}return e.prototype.encrypt=function(t,n){for(var r=n.getUint32(0,!1),i=n.getUint32(4,!1),a=0,o=0;o<this.rounds/2;o++)a+=e.delta,r+=(i<<4)+this.k0^i+a^(i>>>5)+this.k1,i+=(r<<4)+this.k2^r+a^(r>>>5)+this.k3;t.setUint32(0,r,!1),t.setUint32(4,i,!1)},e.prototype.decrypt=function(t,n){for(var r=n.getUint32(0,!1),i=n.getUint32(4,!1),a=e.delta*this.rounds/2,o=0;o<this.rounds/2;o++)i-=(r<<4)+this.k2^r+a^(r>>>5)+this.k3,r-=(i<<4)+this.k0^i+a^(i>>>5)+this.k1,a-=e.delta;t.setUint32(0,r,!1),t.setUint32(4,i,!1)},e.BlockSize=8,e.KeySize=16,e.delta=2654435769,e.numRounds=64,e}()},"0f92":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return u}));n("e291"),n("a707"),n("f07e"),n("e770"),n("f9f6");var r=n("d9c4"),i=n("a42f"),a=n("cbac"),o=n.n(a),c=n("cc74"),s=n("97e5");function u(t,n,a,s){var u,h,b;return Object(r["a"])(this,void 0,Promise,(function(){var m,p,v,g,w;return Object(r["c"])(this,(function(r){switch(r.label){case 0:return[4,Object(i["parseBlob"])(t)];case 1:for(p in m=r.sent(),m.native)m.native.hasOwnProperty(p)&&m.native[p].some((function(e){return"TCON"===e.id&&"(12)"===e.value}))&&(console.warn("try using gbk encoding to decode meta"),m.common.artist=o.a.decode(new e(null!==(u=m.common.artist)&&void 0!==u?u:""),"gbk"),m.common.title=o.a.decode(new e(null!==(h=m.common.title)&&void 0!==h?h:""),"gbk"),m.common.album=o.a.decode(new e(null!==(b=m.common.album)&&void 0!==b?b:""),"gbk"));if(s)try{return[2,l(s,a,m,t)]}catch(y){console.warn("在线获取曲目信息失败，回退到本地 meta 提取",y)}return v=Object(c["f"])(n,m.common.title,m.common.artist),v.artist=v.artist||"",g=Object(c["d"])(m),g?[3,3]:[4,f(v.title,v.artist,m.common.album)];case 2:g=r.sent(),r.label=3;case 3:return w={title:v.title,artist:v.artist||"",album:m.common.album||"",imgUrl:g},[4,d({title:v.title,artists:v.artist.split(" _ "),ext:a,imageURL:g,musicMeta:m,blob:t})];case 4:return[2,(w.blob=r.sent(),w)]}}))}))}function l(e,t,n,i){return Object(r["a"])(this,void 0,Promise,(function(){var a,o,c,u;return Object(r["c"])(this,(function(r){switch(r.label){case 0:return[4,Object(s["e"])(e)];case 1:return a=r.sent(),o=Object(s["c"])(a.track_info.album.pmid),c=a.track_info.singer.map((function(e){return e.name})),u={title:a.track_info.title,artist:c.join("、"),album:a.track_info.album.name,imgUrl:o},[4,d({title:a.track_info.title,artists:c,ext:t,imageURL:o,musicMeta:n,blob:i})];case 2:return[2,(u.blob=r.sent(),u)]}}))}))}function f(e,t,n){return Object(r["a"])(this,void 0,Promise,(function(){var i,a;return Object(r["c"])(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(s["d"])(e,t,n)];case 1:return i=r.sent(),[2,Object(s["c"])(i.Id,i.Type)];case 2:return a=r.sent(),console.warn(a),[3,3];case 3:return[2,""]}}))}))}function d(t){return Object(r["a"])(this,void 0,Promise,(function(){var n,i,a,o,s,u,l;return Object(r["c"])(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,Object(c["e"])(t.imageURL)];case 1:return n=r.sent(),n||console.warn("获取图像失败"),i={picture:null===n||void 0===n?void 0:n.buffer,title:t.title,artists:t.artists},s=(o=e).from,[4,t.blob.arrayBuffer()];case 2:return a=s.apply(o,[r.sent()]),u=c["a"][t.ext]||c["a"].mp3,"mp3"===t.ext?[2,new Blob([Object(c["j"])(a,i,t.musicMeta)],{type:u})]:"flac"===t.ext?[2,new Blob([Object(c["i"])(a,i,t.musicMeta)],{type:u})]:(console.info("writing metadata for "+t.ext+" is not being supported for now"),[3,4]);case 3:return l=r.sent(),console.warn("Error while appending cover image to file "+l),[3,4];case 4:return[2,t.blob]}}))}))}}).call(this,n("257d").Buffer)},1:function(e,t){},2:function(e,t){},2849:function(e,t,n){},3:function(e,t){},3080:function(e,t,n){"use strict";n("7251")},"38f1":function(e,t,n){},"3b55":function(e,t,n){},4:function(e,t){},"4e96":function(e,t,n){"use strict";n("38f1")},5:function(e,t){},"507a":function(e,t,n){"use strict";n.d(t,"a",(function(){return $}));n("e291"),n("f07e");var r=n("d9c4"),i=n("6d95"),a=(n("60d5"),n("d65e"),n("2299"),n("0533"),n("10dd"),n("9174"),n("997c"),n("d5e4"),n("5247"),n("8ef3"),n("9037"),n("f980"),n("b4d6"),n("35cf"),n("b5f6"),n("b233"),n("cbd8"),n("1a5f"),n("282e"),n("32b3"),n("63dc"),n("cf74"),n("949b"),n("03e8"),n("98e1"),n("9c17"),n("7646"),n("796c"),n("3df6"),n("b63f"),n("f726"),n("33e9"),n("7ddc"),n("6f3a"),n("34a8"),n("cc74")),o=n("a42f");function c(e,t,n){return Object(r["a"])(this,void 0,Promise,(function(){var i,c,s,u,l,f,d,h,b;return Object(r["c"])(this,(function(r){switch(r.label){case 0:return c=Uint8Array.bind,[4,Object(a["c"])(e)];case 1:for(i=new(c.apply(Uint8Array,[void 0,r.sent()])),s=i.length,u=0;u<s;u++)i[u]^=163;return l=Object(a["g"])(i,n),l!==n&&(e=new Blob([i],{type:a["a"][l]})),[4,Object(o["parseBlob"])(e)];case 2:return f=r.sent(),d=Object(a["f"])(t,f.common.title,f.common.artist),h=d.title,b=d.artist,[2,{title:h,artist:b,ext:l,album:f.common.album,picture:Object(a["d"])(f),file:URL.createObjectURL(e),blob:e,mime:a["a"][l]}]}}))}))}n("83ea"),n("6367");function s(e,t,n,i){return void 0===i&&(i=!0),Object(r["a"])(this,void 0,Promise,(function(){var c,s,u,l,f,d,h;return Object(r["c"])(this,(function(r){switch(r.label){case 0:return c=n,i?(u=Uint8Array.bind,[4,Object(a["c"])(e)]):[3,2];case 1:s=new(u.apply(Uint8Array,[void 0,r.sent()])),c=Object(a["g"])(s,n),c!==n&&(e=new Blob([s],{type:a["a"][c]})),r.label=2;case 2:return[4,Object(o["parseBlob"])(e)];case 3:return l=r.sent(),f=Object(a["f"])(t,l.common.title,l.common.artist),d=f.title,h=f.artist,[2,{title:d,artist:h,ext:c,album:l.common.album,picture:Object(a["d"])(l),file:URL.createObjectURL(e),blob:e,mime:a["a"][c]}]}}))}))}var u=[105,102,109,116],l=[254,254,254,254],f={" WAV":".wav",FLAC:".flac"," MP3":".mp3"," A4M":".m4a"};function d(e,t,n){return Object(r["a"])(this,void 0,Promise,(function(){var i,c,d,h,b,m,p,v,g,w,y,O,j,x,k;return Object(r["c"])(this,(function(r){switch(r.label){case 0:return c=Uint8Array.bind,[4,Object(a["c"])(e)];case 1:if(i=new(c.apply(Uint8Array,[void 0,r.sent()])),Object(a["b"])(i,u)&&Object(a["b"])(i.slice(8,12),l))return[3,4];if("xm"!==n)return[3,2];throw Error("此xm文件已损坏");case 2:return[4,s(e,t,n,!0)];case 3:return[2,r.sent()];case 4:if(d=(new TextDecoder).decode(i.slice(4,8)),!f.hasOwnProperty(d))throw Error("未知的.xm文件类型");for(h=i[15],b=i[12]|i[13]<<8|i[14]<<16,m=i.slice(16),p=m.length,v=b;v<p;++v)m[v]=m[v]-h^255;return g=f[d],w=a["a"][g],y=new Blob([m],{type:w}),[4,Object(o["parseBlob"])(y)];case 5:return O=r.sent(),"wav"===g&&(console.info(O.common),O.common.album="",O.common.artist="",O.common.title=""),j=Object(a["f"])(t,O.common.title,O.common.artist,-1===t.indexOf("_")?"-":"_"),x=j.title,k=j.artist,[2,{title:x,artist:k,ext:g,mime:w,album:O.common.album,picture:Object(a["d"])(O),file:URL.createObjectURL(y),blob:y,rawExt:"xm"}]}}))}))}n("3e6b"),n("7b4c");var h=function(){function e(){}return e.prototype.getMask=function(t){return t>32767&&(t%=32767),e.staticCipherBox[t*t+27&255]},e.prototype.decrypt=function(e,t){for(var n=0;n<e.length;n++)e[n]^=this.getMask(t+n)},e.staticCipherBox=new Uint8Array([119,72,50,115,222,242,192,200,149,236,48,178,81,195,225,160,158,230,157,207,250,127,20,209,206,184,220,195,74,103,147,214,40,194,145,112,202,141,162,164,240,8,97,144,126,111,162,224,235,174,62,182,103,199,146,244,145,181,246,108,94,132,64,247,243,27,2,127,213,171,65,137,40,244,37,204,82,17,173,67,104,166,65,139,132,181,255,44,146,74,38,216,71,106,124,149,97,204,230,203,187,63,71,88,137,117,195,117,161,217,175,204,8,115,23,220,170,154,162,22,65,216,162,6,198,139,252,102,52,159,207,24,35,160,10,116,231,43,39,112,146,233,175,55,230,140,167,188,98,101,156,194,8,201,136,179,243,67,172,116,44,15,212,175,161,195,1,100,149,78,72,159,244,53,120,149,122,57,214,106,160,109,64,232,79,168,239,17,29,243,27,63,63,7,221,111,91,25,48,25,251,239,14,55,240,14,205,22,73,254,83,71,19,26,189,164,241,64,25,96,14,237,104,9,6,95,77,207,61,26,254,32,119,228,217,218,249,164,43,118,28,113,219,0,188,253,12,108,165,71,247,246,0,121,74,17]),e}(),b=function(){function e(e){if(0==e.length)throw Error("qmc/cipher_map: invalid key size");this.key=e,this.n=e.length}return e.rotate=function(e,t){var n=(t+4)%8,r=e<<n,i=e>>n;return 255&(r|i)},e.prototype.decrypt=function(e,t){for(var n=0;n<e.length;n++)e[n]^=this.getMask(t+n)},e.prototype.getMask=function(t){t>32767&&(t%=32767);var n=(t*t+71214)%this.n;return e.rotate(this.key[n],7&n)},e}(),m=function(){function e(e){var t;if(0==e.length)throw Error("invalid key size");this.key=e,this.N=e.length,this.S=new Uint8Array(this.N);for(var n=0;n<this.N;++n)this.S[n]=255&n;var r=0;for(n=0;n<this.N;++n)r=(this.S[n]+r+this.key[n%this.N])%this.N,t=[this.S[r],this.S[n]],this.S[n]=t[0],this.S[r]=t[1];this.hash=1;for(n=0;n<this.N;n++){var i=this.key[n];if(i){var a=this.hash*i>>>0;if(0==a||a<=this.hash)break;this.hash=a}}}return e.prototype.decrypt=function(t,n){var r=t.length,i=0,a=function(e){return r-=e,i+=e,n+=e,0==r};if(n<e.FIRST_SEGMENT_SIZE){var o=Math.min(t.length,e.FIRST_SEGMENT_SIZE-n);if(this.encFirstSegment(t.subarray(0,o),n),a(o))return}if(n%e.SEGMENT_SIZE!=0){o=Math.min(e.SEGMENT_SIZE-n%e.SEGMENT_SIZE,r);if(this.encASegment(t.subarray(i,i+o),n),a(o))return}while(r>e.SEGMENT_SIZE)this.encASegment(t.subarray(i,i+e.SEGMENT_SIZE),n),a(e.SEGMENT_SIZE);r>0&&this.encASegment(t.subarray(i),n)},e.prototype.encFirstSegment=function(e,t){for(var n=0;n<e.length;n++)e[n]^=this.key[this.getSegmentKey(t+n)]},e.prototype.encASegment=function(t,n){for(var r,i=this.S.slice(0),a=n%e.SEGMENT_SIZE+this.getSegmentKey(Math.floor(n/e.SEGMENT_SIZE)),o=0,c=0,s=-a;s<t.length;s++)o=(o+1)%this.N,c=(i[o]+c)%this.N,r=[i[o],i[c]],i[c]=r[0],i[o]=r[1],s>=0&&(t[s]^=i[(i[o]+i[c])%this.N])},e.prototype.getSegmentKey=function(e){var t=this.key[e%this.N],n=Math.floor(this.hash/((e+1)*t)*100);return n%this.N},e.FIRST_SEGMENT_SIZE=128,e.SEGMENT_SIZE=5120,e}(),p=n("fa01"),v=(n("f9f6"),n("2ff4"),n("6bba"),n("eba8")),g=n.n(v);n("49c1");function w(e){var t=0;e.forEach((function(e){t+=e.length}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(e,r),r+=e.length})),n}var y=40,O=2097152;function j(e){return Object(r["a"])(this,void 0,Promise,(function(){var t,n,i,a,o,c,s,u,l,f,d,h,b,m,p,v,j,x,k,_,U;return Object(r["c"])(this,(function(r){switch(r.label){case 0:t={success:!1,data:new Uint8Array,songId:0,error:""},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,g()()];case 2:return n=r.sent(),[3,4];case 3:return i=r.sent(),t.error=(null===i||void 0===i?void 0:i.message)||"wasm 加载失败",[2,t];case 4:if(a=new Uint8Array(e.slice(-y)),o=n._malloc(a.length),n.writeArrayToMemory(a,o),c=n._malloc(n.sizeof_qmc_detection()),s=n.detectKeyEndPosition(c,o,a.length),u=n.getValue(c,"i32"),l=n.getValue(c+4,"i32"),t.success=s,t.error=n.UTF8ToString(c+n.offsetof_error_msg(),n.sizeof_error_msg()),f=n.UTF8ToString(c+n.offsetof_song_id(),n.sizeof_song_id()),f?/^\d+$/.test(f)?t.songId=f:console.warn("qmc2-wasm: Invalid songId: %s",f):console.debug("qmc2-wasm: songId not found"),n._free(o),n._free(c),!s)return[2,t];d=e.byteLength-y+u,h=new Uint8Array(e.slice(d,d+l)),b=new TextDecoder,m=b.decode(h),p=n.createInstWidthEKey(m,106,"386ZJY!@#*$%^&)(","**#!(#$%&^a1cZ,T"),v=n._malloc(O),j=[],x=0,k=d;while(k>0)_=Math.min(k,O),U=new Uint8Array(e.slice(x,x+_)),n.writeArrayToMemory(U,v),n.decryptStream(p,v,x,_),j.push(n.HEAPU8.slice(v,v+_)),x+=_,k-=_;return n._free(v),p.delete(),t.data=w(j),[2,t]}}))}))}var x=n("0f92"),k={mgg:{ext:"ogg",version:2},mgg0:{ext:"ogg",version:2},mggl:{ext:"ogg",version:2},mgg1:{ext:"ogg",version:2},mflac:{ext:"flac",version:2},mflac0:{ext:"flac",version:2},qmcflac:{ext:"flac",version:2},qmcogg:{ext:"ogg",version:2},qmc0:{ext:"mp3",version:1},qmc2:{ext:"ogg",version:1},qmc3:{ext:"mp3",version:1},bkcmp3:{ext:"mp3",version:1},bkcflac:{ext:"flac",version:1},tkm:{ext:"m4a",version:1},"666c6163":{ext:"flac",version:1},"6d7033":{ext:"mp3",version:1},"6f6767":{ext:"ogg",version:1},"6d3461":{ext:"m4a",version:1},776176:{ext:"wav",version:1}};function _(e,t,n){return Object(r["a"])(this,void 0,Promise,(function(){var i,o,c,s,u,l,f,d,h,b,m,p,v,g,w;return Object(r["c"])(this,(function(r){switch(r.label){case 0:if(!(n in k))throw"Qmc cannot handle type: ".concat(n);return i=k[n],o=i.version,[4,Object(a["c"])(e)];case 1:return c=r.sent(),2===o&&globalThis.WebAssembly?(console.log("qmc: using wasm decoder"),[4,j(c)]):[3,3];case 2:l=r.sent(),l.success?(s=l.data,u=l.songId):console.warn("qmc2-wasm failed with error %s",l.error||"(no error)"),r.label=3;case 3:return s||(console.log("qmc: using js decoder"),f=new U(new Uint8Array(c)),s=f.decrypt(),u=f.songID),d=Object(a["g"])(s,i.ext),h=a["a"][d],[4,Object(x["a"])(new Blob([s],{type:h}),t,d,u)];case 4:return b=r.sent(),m=b.album,p=b.artist,v=b.imgUrl,g=b.blob,w=b.title,[2,{title:w,artist:p,ext:d,album:m,picture:v,file:URL.createObjectURL(g),blob:g,mime:h}]}}))}))}var U=function(){function e(e){this.decoded=!1,this.file=e,this.size=e.length,this.searchKey()}return Object.defineProperty(e.prototype,"songID",{get:function(){return this._songID},enumerable:!1,configurable:!0}),e.prototype.decrypt=function(){if(!this.cipher)throw new Error("no cipher found");if(!this.audioSize||this.audioSize<=0)throw new Error("invalid audio size");var e=this.file.subarray(0,this.audioSize);return this.decoded||(this.cipher.decrypt(e,0),this.decoded=!0),e},e.prototype.searchKey=function(){var t=this.file.slice(-4),n=new TextDecoder;if("QTag"===n.decode(t)){var r=this.file.slice(-8,-4),i=new DataView(r.buffer,r.byteOffset),a=i.getUint32(0,!1);this.audioSize=this.size-a-8;var o=this.file.subarray(this.audioSize,this.size-8),c=o.findIndex((function(t){return t==e.BYTE_COMMA}));if(c<0)throw new Error("invalid key: search raw key failed");this.setCipher(o.subarray(0,c));var s=o.subarray(c+1),u=s.findIndex((function(t){return t==e.BYTE_COMMA}));if(c<0)throw new Error("invalid key: search song id failed");this._songID=parseInt(n.decode(s.subarray(0,u)),10)}else{i=new DataView(t.buffer,t.byteOffset),a=i.getUint32(0,!0);if(a<768){this.audioSize=this.size-a-4;o=this.file.subarray(this.audioSize,this.size-4);this.setCipher(o)}else this.audioSize=this.size,this.cipher=new h}},e.prototype.setCipher=function(e){var t=Object(p["a"])(e);t.length>300?this.cipher=new m(t):this.cipher=new b(t)},e.BYTE_COMMA=",".charCodeAt(0),e}();function S(e,t,n){return Object(r["a"])(this,void 0,Promise,(function(){var n,i,c,s,u,l,f,d,h,b,m;return Object(r["c"])(this,(function(r){switch(r.label){case 0:return i=Uint8Array.bind,[4,Object(a["c"])(e)];case 1:for(n=new(i.apply(Uint8Array,[void 0,r.sent()])),c=n.length,s=0;s<c;s++)n[s]^=244,n[s]<=63?n[s]=4*n[s]:n[s]<=127?n[s]=4*(n[s]-64)+1:n[s]<=191?n[s]=4*(n[s]-128)+2:n[s]=4*(n[s]-192)+3;if(u=Object(a["g"])(n,""),l=Object(a["h"])(t),""===u&&"mp3"!==l.ext){if(l.ext in k)return f=new Blob([n],{type:"application/octet-stream"}),[2,_(f,l.name,l.ext)];throw"不支持的QQ音乐缓存格式"}return f=new Blob([n],{type:a["a"][u]}),[4,Object(o["parseBlob"])(f)];case 2:return d=r.sent(),h=Object(a["f"])(t,d.common.title,d.common.artist),b=h.title,m=h.artist,[2,{title:b,artist:m,ext:u,album:d.common.album,picture:Object(a["d"])(d),file:URL.createObjectURL(f),blob:f,mime:a["a"][u]}]}}))}))}n("d1e5");var T=n("8a65"),A=[5,40,188,150,233,228,90,67,145,170,189,208,122,245,54,49],M=[124,213,50,235,134,2,127,75,168,175,166,142,15,255,153,20];function E(e,t,n){return Object(r["a"])(this,void 0,Promise,(function(){var i,c,s,u,l,f,d,h,b,m,p,v,g,w,y,O;return Object(r["c"])(this,(function(r){switch(r.label){case 0:return c=Uint8Array.bind,[4,Object(a["c"])(e)];case 1:if(i=new(c.apply(Uint8Array,[void 0,r.sent()])),"vpr"===n){if(!Object(a["b"])(i,A))throw Error("Not a valid vpr file!")}else if(!Object(a["b"])(i,M))throw Error("Not a valid kgm(a) file!");for(s=new DataView(i.slice(16,20).buffer),u=s.getUint32(0,!0),l=i.slice(u),f=l.length,d=Array.from(i.slice(28,44)),d.push(0),h="vpr"===n?T["decryptVprByteAtOffset"]:T["decryptKgmByteAtOffsetV2"],b=0;b<f;b++)l[b]=h(l[b],d,b);return m=Object(a["g"])(l),p=a["a"][m],v=new Blob([l],{type:p}),[4,Object(o["parseBlob"])(v)];case 2:return g=r.sent(),w=Object(a["f"])(t,g.common.title,g.common.artist),y=w.title,O=w.artist,[2,{album:g.common.album,picture:Object(a["d"])(g),file:URL.createObjectURL(v),blob:v,ext:m,mime:p,title:y,artist:O}]}}))}))}n("477e"),n("5448");var D=[121,101,101,108,105,111,110,45,107,117,119,111,45,116,109,101],P="MoOtOiTvINGwd2E6n0E1i7L5t2IoOoNk";function I(e,t,n){return Object(r["a"])(this,void 0,Promise,(function(){var n,i,c,u,l,f,d,h,b,m,p,v,g,w;return Object(r["c"])(this,(function(r){switch(r.label){case 0:return i=Uint8Array.bind,[4,Object(a["c"])(e)];case 1:return n=new(i.apply(Uint8Array,[void 0,r.sent()])),Object(a["b"])(n,D)?[3,4]:"aac"!==Object(a["g"])(n)?[3,3]:[4,s(e,t,"aac",!1)];case 2:return[2,r.sent()];case 3:throw Error("not a valid kwm file");case 4:for(c=n.slice(24,32),u=C(c),l=n.slice(1024),f=l.length,d=0;d<f;++d)l[d]^=u[d%32];return h=Object(a["g"])(l),b=a["a"][h],m=new Blob([l],{type:b}),[4,Object(o["parseBlob"])(m)];case 5:return p=r.sent(),v=Object(a["f"])(t,p.common.title,p.common.artist),g=v.title,w=v.artist,[2,{album:p.common.album,picture:Object(a["d"])(p),file:URL.createObjectURL(m),blob:m,mime:b,title:g,artist:w,ext:h}]}}))}))}function C(e){for(var t=new DataView(e.buffer),n=t.getBigUint64(0,!0).toString(),r=N(n),i=new Uint8Array(32),a=0;a<32;a++)i[a]=P.charCodeAt(a)^r.charCodeAt(a);return i}function N(e){var t=e.length,n=e;return t>32?n=e.slice(0,32):t<32&&(n=e.padEnd(32,e)),n}var B=[0,0,0,32,102,116,121,112];function L(e,t){return Object(r["a"])(this,void 0,Promise,(function(){var n,i,o,c;return Object(r["c"])(this,(function(r){switch(r.label){case 0:return i=Uint8Array.bind,[4,Object(a["c"])(e)];case 1:for(n=new(i.apply(Uint8Array,[void 0,r.sent()])),o=0;o<8;++o)n[o]=B[o];return c=new Blob([n],{type:"audio/mp4"}),[4,s(c,t,"m4a",!1)];case 2:return[2,r.sent()]}}))}))}n("10a15");var q=n("1b47"),R=n.n(q),F=n("b7c7");function z(e,t,n){var i;return Object(r["a"])(this,void 0,Promise,(function(){var n,o,c,s,u,l,f,d,h,b,m,p,v,g;return Object(r["c"])(this,(function(r){switch(r.label){case 0:return[4,F["a"].loadJooxUUID("")];case 1:if(n=r.sent(),!n||32!==n.length)throw new Error("请在“解密设定”填写应用 Joox 应用的 UUID。");return c=Uint8Array.bind,[4,Object(a["c"])(e)];case 2:if(o=new(c.apply(Uint8Array,[void 0,r.sent()])),s=R()(o,n),!s)throw new Error("不支持的 joox 加密格式");return u=w(s.decryptFile(o)),l=Object(a["g"])(u),f=a["a"][l],d=null===(i=t.match(/^(\d+)\s\[mqms\d*]$/i))||void 0===i?void 0:i[1],[4,Object(x["a"])(new Blob([u],{type:f}),t,l,d)];case 3:return h=r.sent(),b=h.album,m=h.artist,p=h.imgUrl,v=h.blob,g=h.title,[2,{title:g,artist:m,ext:l,album:b,picture:p,file:URL.createObjectURL(v),blob:v,mime:f}]}}))}))}var Q=n("efc0");function $(e,t){return Object(r["a"])(this,void 0,Promise,(function(){var n,o,u;return Object(r["c"])(this,(function(r){switch(r.label){case 0:return F["a"]instanceof Q["a"]?[4,F["a"].setAll(t)]:[3,2];case 1:r.sent(),r.label=2;case 2:switch(n=Object(a["h"])(e.name),u=n.ext,u){case"ncm":return[3,3];case"uc":return[3,5];case"kwm":return[3,7];case"xm":return[3,9];case"wav":return[3,9];case"mp3":return[3,9];case"flac":return[3,9];case"m4a":return[3,9];case"tm0":return[3,11];case"tm3":return[3,11];case"qmc3":return[3,13];case"qmc2":return[3,13];case"qmc0":return[3,13];case"qmcflac":return[3,13];case"qmcogg":return[3,13];case"tkm":return[3,13];case"bkcmp3":return[3,13];case"bkcm4a":return[3,13];case"bkcflac":return[3,13];case"bkcwav":return[3,13];case"bkcape":return[3,13];case"bkcogg":return[3,13];case"bkcwma":return[3,13];case"mggl":return[3,13];case"mflac":return[3,13];case"mflac0":return[3,13];case"mgg":return[3,13];case"mgg1":return[3,13];case"mgg0":return[3,13];case"666c6163":return[3,13];case"6d7033":return[3,13];case"6f6767":return[3,13];case"6d3461":return[3,13];case"776176":return[3,13];case"tm2":return[3,15];case"tm6":return[3,15];case"cache":return[3,17];case"vpr":return[3,19];case"kgm":return[3,19];case"kgma":return[3,19];case"ofl_en":return[3,21]}return[3,23];case 3:return[4,Object(i["a"])(e.raw,n.name,n.ext)];case 4:return o=r.sent(),[3,24];case 5:return[4,c(e.raw,n.name,n.ext)];case 6:return o=r.sent(),[3,24];case 7:return[4,I(e.raw,n.name,n.ext)];case 8:return o=r.sent(),[3,24];case 9:return[4,d(e.raw,n.name,n.ext)];case 10:return o=r.sent(),[3,24];case 11:return[4,s(e.raw,n.name,"mp3")];case 12:return o=r.sent(),[3,24];case 13:return[4,_(e.raw,n.name,n.ext)];case 14:return o=r.sent(),[3,24];case 15:return[4,L(e.raw,n.name)];case 16:return o=r.sent(),[3,24];case 17:return[4,S(e.raw,n.name,n.ext)];case 18:return o=r.sent(),[3,24];case 19:return[4,E(e.raw,n.name,n.ext)];case 20:return o=r.sent(),[3,24];case 21:return[4,z(e.raw,n.name,n.ext)];case 22:return o=r.sent(),[3,24];case 23:throw"不支持此文件格式";case 24:return o.rawExt||(o.rawExt=n.ext),o.rawFilename||(o.rawFilename=n.name),console.log(o),[2,o]}}))}))}},"50d1":function(e,t,n){},6:function(e,t){},"675e":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="um.conf.",i="".concat(r,"joox.uuid"),a=function(){function e(){}return e.prototype.saveJooxUUID=function(e){return this.save(i,e)},e.prototype.loadJooxUUID=function(e){return void 0===e&&(e=""),this.load(i,e)},e}();t["b"]=a},"6d95":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return _}));n("e291"),n("60d5"),n("d65e"),n("2299"),n("0533"),n("10dd"),n("9174"),n("997c"),n("d5e4"),n("5247"),n("8ef3"),n("9037"),n("f980"),n("b4d6"),n("35cf"),n("b5f6"),n("b233"),n("cbd8"),n("1a5f"),n("282e"),n("32b3"),n("63dc"),n("cf74"),n("949b"),n("03e8"),n("98e1"),n("9c17"),n("7646"),n("796c"),n("3df6"),n("b63f"),n("f726"),n("6367"),n("a707"),n("83ea"),n("7ddc"),n("477e"),n("2ff4"),n("7e1b"),n("49c1"),n("f9f6"),n("ea98"),n("ab15"),n("e770"),n("33e9"),n("6f3a"),n("34a8");var r=n("d9c4"),i=n("cc74"),a=n("a42f"),o=n("5e72"),c=n.n(o),s=n("11a9"),u=n.n(s),l=n("e1d1"),f=n.n(l),d=n("bf28"),h=n.n(d),b=n("b6ad"),m=n.n(b),p=n("870c"),v=n.n(p),g=n("b78d"),w=n.n(g),y=n("3f6a"),O=n.n(y),j=O.a.parse("687a4852416d736f356b496e62617857"),x=O.a.parse("2331346C6A6B5F215C5D2630553C2728"),k=[67,84,69,78,70,68,65,77];function _(e,t,n){return Object(r["a"])(this,void 0,Promise,(function(){var n;return Object(r["c"])(this,(function(r){switch(r.label){case 0:return n=U.bind,[4,Object(i["c"])(e)];case 1:return[2,(new(n.apply(U,[void 0,r.sent(),t]))).decrypt()]}}))}))}var U=function(){function t(e,t){this.offset=0,this.format="",this.mime="";var n=new Uint8Array(e,0,8);if(!Object(i["b"])(n,k))throw Error("此ncm文件已损坏");this.offset=10,this.raw=e,this.view=new DataView(e),this.filename=t}return t.prototype._getKeyData=function(){var e=this.view.getUint32(this.offset,!0);this.offset+=4;var t=new Uint8Array(this.raw,this.offset,e).map((function(e){return 100^e}));this.offset+=e;for(var n=u.a.decrypt({ciphertext:m.a.create(t)},j,{mode:h.a,padding:f.a}),r=new Uint8Array(n.sigBytes),i=n.words,a=n.sigBytes,o=0;o<a;o++)r[o]=i[o>>>2]>>>24-o%4*8&255;return r.slice(17)},t.prototype._getKeyBox=function(){for(var e,t=this._getKeyData(),n=new Uint8Array(Array(256).keys()),r=t.length,i=0,a=0;a<256;a++)i=n[a]+i+t[a%r]&255,e=[n[i],n[a]],n[a]=e[0],n[i]=e[1];return n.map((function(e,t,n){t=t+1&255;var r=n[t],i=n[t+r&255];return n[r+i&255]}))},t.prototype._getMetaData=function(){var e=this.view.getUint32(this.offset,!0);if(this.offset+=4,0===e)return{};var t=new Uint8Array(this.raw,this.offset,e).map((function(e){return 99^e}));this.offset+=e,m.a.create();var n,r=u.a.decrypt({ciphertext:v.a.parse(m.a.create(t.slice(22)).toString(w.a))},x,{mode:h.a,padding:f.a}).toString(w.a),i=r.indexOf(":");if("dj"===r.slice(0,i)){var a=JSON.parse(r.slice(i+1));n=a.mainMusic}else n=JSON.parse(r.slice(i+1));return n.albumPic&&(n.albumPic=n.albumPic.replace("http://","https://")+"?param=500y500"),n},t.prototype._getAudio=function(e){this.offset+=this.view.getUint32(this.offset+5,!0)+13;for(var t=new Uint8Array(this.raw,this.offset),n=t.length,r=0;r<n;++r)t[r]^=e[255&r];return t},t.prototype._buildMeta=function(){var t;return Object(r["a"])(this,void 0,void 0,(function(){var n,a,o,s,u,l;return Object(r["c"])(this,(function(r){switch(r.label){case 0:if(!this.oriMeta)throw Error("invalid sequence");if(n=Object(i["f"])(this.filename,this.oriMeta.musicName),a=[],this.oriMeta.artist&&this.oriMeta.artist.forEach((function(e){return a.push(e[0])})),0===a.length&&n.artist&&(a=n.artist.split(",").map((function(e){return e.trim()})).filter((function(e){return""!=e}))),!this.oriMeta.albumPic)return[3,9];r.label=1;case 1:return r.trys.push([1,8,,9]),o=this,[4,Object(i["e"])(this.oriMeta.albumPic)];case 2:o.image=r.sent(),r.label=3;case 3:return this.image&&this.image.buffer.byteLength>=1<<24?[4,c.a.read(e.from(this.image.buffer))]:[3,7];case 4:return s=r.sent(),[4,s.resize(Math.round(s.getHeight()/2),c.a.AUTO)];case 5:return r.sent(),u=this.image,[4,s.getBufferAsync("image/jpeg")];case 6:return u.buffer=r.sent(),[3,3];case 7:return[3,9];case 8:return l=r.sent(),console.log("get cover image failed",l),[3,9];case 9:return this.newMeta={title:n.title,artists:a,album:this.oriMeta.album,picture:null===(t=this.image)||void 0===t?void 0:t.buffer},[2]}}))}))},t.prototype._writeMeta=function(){return Object(r["a"])(this,void 0,void 0,(function(){var t,n;return Object(r["c"])(this,(function(r){switch(r.label){case 0:if(!this.audio||!this.newMeta)throw Error("invalid sequence");return this.blob||(this.blob=new Blob([this.audio],{type:this.mime})),[4,Object(a["parseBlob"])(this.blob)];case 1:if(t=r.sent(),n=!t.common.album&&!t.common.artists&&!t.common.title,n||this.newMeta.picture){if("mp3"===this.format)this.audio=Object(i["j"])(e.from(this.audio),this.newMeta,t);else{if("flac"!==this.format)return console.info("writing meta for ".concat(this.format," is not being supported for now")),[2];this.audio=Object(i["i"])(e.from(this.audio),this.newMeta,t)}this.blob=new Blob([this.audio],{type:this.mime})}return[2]}}))}))},t.prototype.gatherResult=function(){var e,t;if(!this.newMeta||!this.blob)throw Error("bad sequence");return{title:this.newMeta.title,artist:null===(e=this.newMeta.artists)||void 0===e?void 0:e.join("; "),ext:this.format,album:this.newMeta.album,picture:null===(t=this.image)||void 0===t?void 0:t.url,file:URL.createObjectURL(this.blob),blob:this.blob,mime:this.mime}},t.prototype.decrypt=function(){return Object(r["a"])(this,void 0,void 0,(function(){var e,t;return Object(r["c"])(this,(function(n){switch(n.label){case 0:return e=this._getKeyBox(),this.oriMeta=this._getMetaData(),this.audio=this._getAudio(e),this.format=this.oriMeta.format||Object(i["g"])(this.audio),this.mime=i["a"][this.format],[4,this._buildMeta()];case 1:n.sent(),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,this._writeMeta()];case 3:return n.sent(),[3,5];case 4:return t=n.sent(),console.warn("write meta data failed",t),[3,5];case 5:return[2,this.gatherResult()]}}))}))},t}()}).call(this,n("257d").Buffer)},7251:function(e,t,n){},"73ec":function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"a",(function(){return l}));n("a8dc"),n("f9f6"),n("e291"),n("33e9"),n("7ddc"),n("6f3a"),n("34a8"),n("41e6");var r,i=n("d9c4");(function(e){e[e["ArtistAndTitle"]=0]="ArtistAndTitle",e[e["TitleOnly"]=1]="TitleOnly",e[e["TitleAndArtist"]=2]="TitleAndArtist",e[e["SameAsOriginal"]=3]="SameAsOriginal"})(r||(r={}));var a=[{key:r.ArtistAndTitle,text:"歌手-歌曲名"},{key:r.TitleOnly,text:"歌曲名"},{key:r.TitleAndArtist,text:"歌曲名-歌手"},{key:r.SameAsOriginal,text:"同源文件名"}];function o(e,t){switch(t){case r.TitleOnly:return"".concat(e.title,".").concat(e.ext);case r.TitleAndArtist:return"".concat(e.title," - ").concat(e.artist,".").concat(e.ext);case r.SameAsOriginal:return"".concat(e.rawFilename,".").concat(e.ext);default:case r.ArtistAndTitle:return"".concat(e.artist," - ").concat(e.title,".").concat(e.ext)}}function c(e,t,n){return Object(i["a"])(this,void 0,void 0,(function(){var r,a,c;return Object(i["c"])(this,(function(i){switch(i.label){case 0:r=o(e,t),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,n.getFileHandle(r)];case 2:return i.sent(),r="".concat((new Date).getTime()," - ").concat(r),[3,4];case 3:return i.sent(),[3,4];case 4:return[4,n.getFileHandle(r,{create:!0})];case 5:return a=i.sent(),[4,a.createWritable()];case 6:return c=i.sent(),[4,c.write(e.blob)];case 7:return i.sent(),[4,c.close()];case 8:return i.sent(),[2]}}))}))}function s(e,t){var n=document.createElement("a");n.href=e.file,n.download=o(e,t),document.body.append(n),n.click(),n.remove()}function u(e){var t;URL.revokeObjectURL(e.file),(null===(t=e.picture)||void 0===t?void 0:t.startsWith("blob:"))&&URL.revokeObjectURL(e.picture)}var l=function(){function e(){this.id=1,this.isConsume=!1,this.pending=[],this.id=Date.now(),console.log("创建线程队列",this.id)}return e.prototype.queue=function(e){this.pending.push(e),this.isConsume||this.consume()},e.prototype.consume=function(){var e=this,t=this.pending.shift();t?(this.isConsume=!0,t().then((function(){e.consume()})).catch(console.error)):this.isConsume=!1},e}()},"8bb9":function(e,t,n){"use strict";n("2849")},9224:function(e){e.exports=JSON.parse('{"name":"unlock-music","version":"v1.10.0","ext_build":0,"updateInfo":"重写QMC解锁，完全支持.mflac*/.mgg*; 支持JOOX解锁","license":"MIT","description":"Unlock encrypted music file in browser.","repository":{"type":"git","url":"https://github.com/ix64/unlock-music"},"private":true,"scripts":{"postinstall":"patch-package","serve":"vue-cli-service serve","build":"vue-cli-service build","test":"jest","pretty":"prettier --write src/{**/*,*}.{js,ts,jsx,tsx,vue}","pretty:check":"prettier --check src/{**/*,*}.{js,ts,jsx,tsx,vue}","make-extension":"node ./make-extension.js"},"dependencies":{"@babel/preset-typescript":"^7.21.0","@jixun/kugou-crypto":"^1.0.3","@jixun/qmc2-crypto":"^1.0.0-R1","@unlock-music/joox-crypto":"^0.0.1-R5","base64-js":"^1.5.1","browser-id3-writer":"^4.4.0","core-js":"^3.29.0","crypto-js":"^4.1.1","element-ui":"^2.15.13","iconv-lite":"^0.6.3","jimp":"^0.16.13","metaflac-js":"^1.0.5","music-metadata":"7.9.0","music-metadata-browser":"2.2.7","register-service-worker":"^1.7.2","threads":"^1.7.0","vue":"^2.7.14"},"devDependencies":{"@types/crypto-js":"^4.1.1","@types/jest":"^27.5.2","@vue/cli-plugin-babel":"^4.5.19","@vue/cli-plugin-pwa":"^4.5.19","@vue/cli-plugin-typescript":"^4.5.19","@vue/cli-service":"^4.5.19","babel-plugin-component":"^1.1.1","jest":"^27.5.1","patch-package":"^6.5.1","prettier":"2.5.1","sass":"^1.58.3","sass-loader":"^10.4.1","semver":"^7.3.8","threads-plugin":"^1.4.0","typescript":"^4.9.5","vue-cli-plugin-element":"^1.0.1","vue-template-compiler":"^2.7.14"}}')},"92b7":function(e,t,n){"use strict";n("50d1")},"952e":function(e,t,n){},"97e5":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return l}));n("e291"),n("c402"),n("33e9"),n("7ddc"),n("34a8"),n("a8dc"),n("477e"),n("6367");var r=n("d9c4"),i="https://um-api.ixarea.com",a="https://www.zhuanhuanyun.cn";function o(e,t,n){return Object(r["a"])(this,void 0,Promise,(function(){var i;return Object(r["c"])(this,(function(r){switch(r.label){case 0:return[4,fetch((t||a)+"/user/conversion",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"musicName="+encodeURIComponent(e)+"&id="+n})];case 1:return i=r.sent(),[4,i.json()];case 2:return[2,r.sent()]}}))}))}function c(e){return Object(r["a"])(this,void 0,Promise,(function(){var t;return Object(r["c"])(this,(function(n){switch(n.label){case 0:return[4,fetch(i+"/music/app-version",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Version:e})})];case 1:return t=n.sent(),[4,t.json()];case 2:return[2,n.sent()]}}))}))}function s(e,t,n){return Object(r["a"])(this,void 0,Promise,(function(){var a,o,c;return Object(r["c"])(this,(function(r){switch(r.label){case 0:return a=i+"/music/qq-cover",o=new URLSearchParams([["Title",e],["Artist",null!==t&&void 0!==t?t:""],["Album",null!==n&&void 0!==n?n:""]]),[4,fetch("".concat(a,"?").concat(o.toString()))];case 1:return c=r.sent(),[4,c.json()];case 2:return[2,r.sent()]}}))}))}function u(e){return Object(r["a"])(this,void 0,Promise,(function(){var t,n;return Object(r["c"])(this,(function(r){switch(r.label){case 0:return t="".concat(i,"/meta/qq-music-raw/").concat(e),[4,fetch(t).then((function(e){return e.json()}))];case 1:if(n=r.sent(),0===n.code&&0===n.req_1.code)return[2,n.req_1.data];throw new Error("请求信息失败")}}))}))}function l(e,t){return void 0===t&&(t=1),"".concat(i,"/music/qq-cover/").concat(t,"/").concat(e)}},"98ef":function(e,t,n){"use strict";n("952e")},abad:function(e,t,n){"use strict";n("e291");t["a"]=function(e){var t=Date.now();return{start:function(){t=Date.now()},wait:function(){return new Promise((function(n){null===t||Date.now()-t>e?(t=null,n()):setTimeout((function(){t=null,n()}),e)}))}}}},b7c7:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));n("e291"),n("c402"),n("5f96"),n("41e6");var r=n("d9c4"),i=n("675e"),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r["b"])(t,e),Object.defineProperty(t,"works",{get:function(){return"undefined"!==typeof localStorage&&localStorage.getItem},enumerable:!1,configurable:!0}),t.prototype.load=function(e,t){return Object(r["a"])(this,void 0,Promise,(function(){var n;return Object(r["c"])(this,(function(r){if(n=localStorage.getItem(e),null===n)return[2,t];try{return[2,JSON.parse(n)]}catch(i){return[2,t]}return[2]}))}))},t.prototype.save=function(e,t){return Object(r["a"])(this,void 0,Promise,(function(){return Object(r["c"])(this,(function(n){return localStorage.setItem(e,JSON.stringify(t)),[2]}))}))},t.prototype.getAll=function(){return Object(r["a"])(this,void 0,Promise,(function(){var e,t,n,a,o,c,s;return Object(r["c"])(this,(function(r){for(e={},t=0,n=Object.entries(localStorage);t<n.length;t++)if(a=n[t],o=a[0],c=a[1],o.startsWith(i["a"]))try{Object.assign(e,(s={},s[o]=JSON.parse(c),s))}catch(u){}return[2,e]}))}))},t.prototype.setAll=function(e){return Object(r["a"])(this,void 0,Promise,(function(){var t,n,i,a,o;return Object(r["c"])(this,(function(r){switch(r.label){case 0:t=0,n=Object.entries(e),r.label=1;case 1:return t<n.length?(i=n[t],a=i[0],o=i[1],[4,this.save(a,o)]):[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},t}(i["b"]),o=a,c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r["b"])(t,e),Object.defineProperty(t,"works",{get:function(){var e,t;return"undefined"!==typeof chrome&&Boolean(null===(t=null===(e=null===chrome||void 0===chrome?void 0:chrome.storage)||void 0===e?void 0:e.local)||void 0===t?void 0:t.set)},enumerable:!1,configurable:!0}),t.prototype.load=function(e,t){return Object(r["a"])(this,void 0,Promise,(function(){return Object(r["c"])(this,(function(n){return[2,new Promise((function(n){var r;chrome.storage.local.get((r={},r[e]=t,r),(function(r){Object.prototype.hasOwnProperty.call(r,e)?n(r[e]):n(t)}))}))]}))}))},t.prototype.save=function(e,t){return Object(r["a"])(this,void 0,Promise,(function(){return Object(r["c"])(this,(function(n){return[2,new Promise((function(n){var r;chrome.storage.local.set((r={},r[e]=t,r),n)}))]}))}))},t.prototype.getAll=function(){return Object(r["a"])(this,void 0,Promise,(function(){return Object(r["c"])(this,(function(e){return[2,new Promise((function(e){chrome.storage.local.get(null,(function(t){for(var n={},r=0,a=Object.entries(t);r<a.length;r++){var o=a[r],c=o[0],s=o[1];c.startsWith(i["a"])&&(n[c]=s)}e(n)}))}))]}))}))},t.prototype.setAll=function(e){return Object(r["a"])(this,void 0,Promise,(function(){return Object(r["c"])(this,(function(t){return[2,new Promise((function(t){chrome.storage.local.set(e,t)}))]}))}))},t}(i["b"]),s=c,u=n("efc0");function l(){return s.works?new s:o.works?new o:new u["a"]}var f=l()},bcc1:function(e,t,n){e.exports=n.p+"js/0.041abfb6.worker.js"},cc74:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return v})),n.d(t,"g",(function(){return g})),n.d(t,"c",(function(){return w})),n.d(t,"d",(function(){return y})),n.d(t,"f",(function(){return O})),n.d(t,"e",(function(){return j})),n.d(t,"j",(function(){return x})),n.d(t,"i",(function(){return k})),n.d(t,"h",(function(){return _}));n("e291"),n("83ea"),n("33e9"),n("7ddc"),n("6f3a"),n("34a8"),n("2ff4"),n("dc78"),n("ab15"),n("f9f6"),n("41e6"),n("49c1");var r=n("d9c4"),i=n("e3b3"),a=n.n(i),o=n("9e39"),c=n.n(o),s=[102,76,97,67],u=[73,68,51],l=[79,103,103,83],f=[102,116,121,112],d=[48,38,178,117,142,102,207,17,166,217,0,170,0,98,206,108],h=[82,73,70,70],b=[255,241],m=[70,82,77,56],p={mp3:"audio/mpeg",flac:"audio/flac",m4a:"audio/mp4",ogg:"audio/ogg",wma:"audio/x-ms-wma",wav:"audio/x-wav",dff:"audio/x-dff"};function v(e,t){return!(t.length>e.length)&&t.every((function(t,n){return t===e[n]}))}function g(e,t){return void 0===t&&(t="mp3"),v(e,u)?"mp3":v(e,s)?"flac":v(e,l)?"ogg":e.length>=4+f.length&&v(e.slice(4),f)?"m4a":v(e,h)?"wav":v(e,d)?"wma":v(e,b)?"aac":v(e,m)?"dff":t}function w(e){return e.arrayBuffer?e.arrayBuffer():new Promise((function(t,n){var r=new FileReader;r.onload=function(e){var r,i=null===(r=e.target)||void 0===r?void 0:r.result;i?t(i):n("read file failed")},r.readAsArrayBuffer(e)}))}function y(e){var t;return(null===(t=e.common)||void 0===t?void 0:t.picture)&&e.common.picture.length>0?URL.createObjectURL(new Blob([e.common.picture[0].data],{type:e.common.picture[0].format})):""}function O(e,t,n,r){void 0===r&&(r="-");var i={title:null!==t&&void 0!==t?t:"",artist:n},a=e.split(r);return a.length>1?(i.artist||(i.artist=a[0].trim()),i.title||(i.title=a[1].trim())):1===a.length&&(i.title||(i.title=a[0].trim())),i}function j(e){return Object(r["a"])(this,void 0,Promise,(function(){var t,n,i,a,o;return Object(r["c"])(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),[4,fetch(e)];case 1:return t=r.sent(),n=t.headers.get("Content-Type"),(null===n||void 0===n?void 0:n.startsWith("image/"))?[4,t.arrayBuffer()]:[3,3];case 2:return i=r.sent(),a=URL.createObjectURL(new Blob([i],{type:n})),[2,{buffer:i,url:a,mime:n}];case 3:return[3,5];case 4:return o=r.sent(),console.warn(o),[3,5];case 5:return[2]}}))}))}function x(e,t,n){var r=new a.a(e),i=n.native["ID3v2.4"]||n.native["ID3v2.3"]||n.native["ID3v2.2"]||[];i.forEach((function(e){if("TPE1"!==e.id&&"TIT2"!==e.id&&"TALB"!==e.id)try{r.setFrame(e.id,e.value)}catch(t){}}));var o=n.common;return r.setFrame("TPE1",(null===o||void 0===o?void 0:o.artists)||t.artists||[]).setFrame("TIT2",(null===o||void 0===o?void 0:o.title)||t.title).setFrame("TALB",(null===o||void 0===o?void 0:o.album)||t.album||""),t.picture&&r.setFrame("APIC",{type:3,data:t.picture,description:t.picture_desc||""}),r.addTag()}function k(t,n,r){var i=new c.a(t),a=r.common;return a.title||a.album||!a.artists||(i.setTag("TITLE="+n.title),i.setTag("ALBUM="+n.album),n.artists&&(i.removeTag("ARTIST"),n.artists.forEach((function(e){return i.setTag("ARTIST="+e)})))),n.picture&&i.importPictureFromBuffer(e.from(n.picture)),i.save()}function _(e){var t=e.lastIndexOf(".");return{ext:e.substring(t+1).toLowerCase(),name:e.substring(0,t)}}}).call(this,n("257d").Buffer)},cd49:function(e,t,n){"use strict";n.r(t);n("e7cc"),n("566d");var r=n("2231"),i=n.n(r),a=(n("e7d5"),n("4fb7")),o=n.n(a),c=(n("0a1a"),n("a328")),s=n.n(c),u=(n("38f5"),n("956c")),l=n.n(u),f=(n("b551"),n("15d3")),d=n.n(f),h=(n("6839"),n("a8f4")),b=n.n(h),m=(n("166c"),n("23cb")),p=n.n(m),v=(n("9c6d"),n("5471")),g=n.n(v),w=(n("c544"),n("7489")),y=n.n(w),O=(n("2155"),n("4286")),j=n.n(O),x=(n("83ca"),n("e9dc")),k=n.n(x),_=(n("76c5"),n("fe3b")),U=n.n(_),S=(n("7775"),n("86fb")),T=n.n(S),A=(n("73b5"),n("c5d0")),M=n.n(A),E=(n("f6a1"),n("41e7")),D=n.n(E),P=(n("99e2"),n("1289")),I=n.n(P),C=(n("5c3c"),n("10c0")),N=n.n(C),B=(n("1084"),n("1c37")),L=n.n(B),q=(n("b000"),n("2be7")),R=n.n(q),F=(n("1dce"),n("48a0")),z=n.n(F),Q=(n("4af0"),n("a5b7")),$=n.n(Q),J=(n("0111"),n("9b42")),V=n.n(J),G=(n("1733"),n("ac89"),n("d601"),n("0491"),n("d797")),W=function(){var e=this,t=e._self._c;return t("el-container",{attrs:{id:"app"}},[t("el-main",[t("Home")],1)],1)},Z=[],H=n("80f6"),K=n("fdd9"),Y=function(){var e=this,t=e._self._c;return t("div",[e._e(),t("el-upload",{staticClass:"upload-warp",attrs:{"auto-upload":!1,"on-change":e.addFile,"show-file-list":!1,action:"",drag:"",multiple:""}},[t("el-button",{staticClass:"select-file-btn",attrs:{plain:""}},[e._v("选择文件")]),t("div",{staticClass:"el-upload__text"},[e._v("或将文件拖到此处")]),t("div",{staticClass:"el-upload__text"},[e._v("注：批量转换建议在20个文件以内，以免浏览器崩溃")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(" 工作模式: "+e._s(e.parallel?"多线程 Worker":"单线程 Queue")+" "),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 将此工具部署在HTTPS环境下，可以启用Web Worker特性，"),t("br"),e._v(" 从而更快的利用并行处理完成解锁 ")]),t("i",{staticClass:"el-icon-info",staticStyle:{"font-size":"12px"}})])],1)]),null==e.overNum?t("p",{staticClass:"b-tip"},[e._v("正在初始化")]):e._e(),null!=e.overNum&&e.id?t("p",{staticClass:"b-tip"},[e._v(" 今日还可转换 "),t("span",{staticClass:"blue"},[e._v(e._s(e.overNum))]),e._v(" 首 ")]):e._e(),null!=e.overNum&&!e.id&&e.isShowTip?t("p",{staticClass:"b-tip"},[e._v("已准备就绪")]):e._e(),t("transition",{attrs:{name:"el-fade-in"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.progress_show,expression:"progress_show"}],staticClass:"loading"},[t("div",{staticClass:"loading-text"},[t("i",{staticClass:"el-icon-loading"}),t("span",[e._v("拼命转换中")])]),t("span",[e._v(e._s(e.progress_string))]),e._e()],1)])],1),t("QQMusicDialog",{ref:"qqMusicDialog"})],1)},X=[],ee=n("f7fd"),te=ee["a"],ne=(n("3080"),n("8619")),re=Object(ne["a"])(te,Y,X,!1,null,null,null),ie=re.exports,ae=function(){var e=this,t=e._self._c;return t("el-table",{staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData}},[t("el-table-column",{attrs:{label:"封面"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-image",{staticClass:"fm-img",attrs:{src:n.row.picture}},[t("div",{staticClass:"image-slot el-image__error",attrs:{slot:"error"},slot:"error"},[e._v("暂无封面")])])]}}])}),t("el-table-column",{attrs:{label:"歌曲"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("span",[e._v(e._s(n.row.title))])]}}])}),t("el-table-column",{attrs:{label:"歌手"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("p",[e._v(e._s(n.row.artist))])]}}])}),t("el-table-column",{attrs:{label:"专辑"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("p",[e._v(e._s(n.row.album))])]}}])}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 播放")]),t("el-button",{staticClass:"btn play-btn",attrs:{color:"#daca14",circle:"",type:"success"},on:{click:function(t){return e.handlePlay(n.$index,n.row)}}},[t("i",{staticClass:"el-icon-caret-right"})])],1),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 下载")]),t("el-button",{staticClass:"btn download-btn",attrs:{circle:""},on:{click:function(t){return e.handleDownload(n.row)}}},[t("i",{staticClass:"el-icon-caret-bottom"})])],1),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 删除")]),t("el-button",{staticClass:"btn delete-btn",attrs:{circle:"",type:"danger"},on:{click:function(t){return e.handleDelete(n.$index,n.row)}}},[t("i",{staticClass:"el-icon-close"})])],1)]}}])})],1)},oe=[],ce=(n("d7e5"),n("747a"),n("73ec")),se={name:"PreviewTable",props:{tableData:{type:Array,required:!0},policy:{type:Number,required:!0}},methods:{handlePlay:function(e,t){this.$emit("play",t.file)},handleDelete:function(e,t){Object(ce["f"])(t),this.tableData.splice(e,1)},handleDownload:function(e){this.$emit("download",e)}}},ue=se,le=(n("92b7"),Object(ne["a"])(ue,ae,oe,!1,null,"78d3bbc0",null)),fe=le.exports,de=n("9224"),he=function(){var e=this,t=e._self._c;return t("div",[t("file-selector",{on:{error:e.showFail,success:e.showSuccess}}),t("div",{attrs:{id:"app-control"}},[t("el-row",{staticClass:"mb-3"},e._l(e.FilenamePolicies,(function(n){return t("el-radio",{key:n.key,staticClass:"radio",attrs:{label:n.key},model:{value:e.filename_policy,callback:function(t){e.filename_policy=t},expression:"filename_policy"}},[e._v(" "+e._s(n.text)+" ")])})),1),t("el-row",[t("config-dialog",{attrs:{show:e.showConfigDialog},on:{done:function(t){e.showConfigDialog=!1}}}),e._e(),t("el-button",{staticClass:"op-btn blue",attrs:{plain:""},on:{click:e.handleDownloadAll}},[e._v("下载全部")]),t("el-button",{staticClass:"op-btn ml-20",attrs:{plain:"",type:"danger"},on:{click:e.handleDeleteAll}},[e._v("清除全部")]),e._e()],1)],1),t("audio",{staticClass:"audio",attrs:{autoplay:e.playing_auto,src:e.playing_url,controls:""}}),t("PreviewTable",{attrs:{policy:e.filename_policy,"table-data":e.tableData},on:{download:e.saveFile,play:e.changePlaying}})],1)},be=[],me=(n("f9f6"),n("e291"),n("49c1"),function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"解密设定",visible:e.show,"custom-class":"um-config-dialog",center:""},on:{close:function(t){return e.cancel()}}},[t("el-form",{ref:"form",attrs:{rules:e.rules,"status-icon":"",model:e.form,"label-width":"0"}},[t("section",[t("label",[t("span",[e._v(" JOOX Music · "),t("Ruby",{attrs:{caption:"Unique Device Identifier"}},[e._v("设备唯一识别码")])],1),t("el-form-item",{attrs:{prop:"jooxUUID"}},[t("el-input",{attrs:{type:"text",clearable:"",maxlength:"32","show-word-limit":""},model:{value:e.form.jooxUUID,callback:function(t){e.$set(e.form,"jooxUUID",t)},expression:"form.jooxUUID"}})],1)],1),t("p",{staticClass:"item-desc"},[e._v(" 下载该加密文件的 JOOX 应用所记录的设备唯一识别码。 "),t("br"),e._v(" 参见： "),t("a",{attrs:{href:"https://github.com/unlock-music/joox-crypto/wiki/%E8%8E%B7%E5%8F%96%E8%AE%BE%E5%A4%87-UUID"}},[e._v(" 获取设备 UUID · unlock-music/joox-crypto Wiki")]),e._v("。 ")])])]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.saving},on:{click:function(t){return e.emitConfirm()}}},[e._v("确 定")])],1)],1)}),pe=[],ve=(n("2ff4"),n("6bba"),n("6367"),n("b7c7")),ge=function(){var e=this,t=e._self._c;return t("ruby",{attrs:{title:e.caption}},[e._t("default"),t("rp",[e._v("（")]),t("rt",{domProps:{textContent:e._s(e.caption)}}),t("rp",[e._v("）")])],2)},we=[],ye={name:"Ruby",props:{caption:{type:String,required:!0}}},Oe=ye,je=Object(ne["a"])(Oe,ge,we,!1,null,null,null),xe=je.exports;function ke(e,t,n){t&&/^[\da-fA-F]{32}$/.test(t)?n():n(new Error("无效的 Joox UUID，请参考 Wiki 获取。"))}var _e={jooxUUID:{validator:ke,trigger:"change"}},Ue={components:{Ruby:xe},props:{show:{type:Boolean,required:!0}},data:function(){return{rules:_e,saving:!1,form:{jooxUUID:""},centerDialogVisible:!1}},mounted:function(){var e=this;return Object(K["a"])(Object(H["a"])().mark((function t(){return Object(H["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.resetForm();case 2:case"end":return t.stop()}}),t)})))()},methods:{resetForm:function(){var e=this;return Object(K["a"])(Object(H["a"])().mark((function t(){return Object(H["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ve["a"].loadJooxUUID();case 2:e.form.jooxUUID=t.sent;case 3:case"end":return t.stop()}}),t)})))()},cancel:function(){var e=this;return Object(K["a"])(Object(H["a"])().mark((function t(){return Object(H["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.resetForm();case 2:e.$emit("done");case 3:case"end":return t.stop()}}),t)})))()},emitConfirm:function(){var e=this;return Object(K["a"])(Object(H["a"])().mark((function t(){return Object(H["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.saving=!0,t.next=3,ve["a"].saveJooxUUID(e.form.jooxUUID);case 3:e.saving=!1,e.$emit("done");case 5:case"end":return t.stop()}}),t)})))()}}},Se=Ue,Te=(n("98ef"),Object(ne["a"])(Se,me,pe,!1,null,"58e4a4a6",null)),Ae=Te.exports,Me={name:"Home",components:{FileSelector:ie,PreviewTable:fe,ConfigDialog:Ae},data:function(){return{showConfigDialog:!1,tableData:[],playing_url:"",playing_auto:!1,filename_policy:ce["e"].ArtistAndTitle,instant_save:!1,FilenamePolicies:ce["d"],dir:null}},watch:{instant_save:function(e){e&&this.showDirectlySave()}},methods:{showSuccess:function(e){var t=this;return Object(K["a"])(Object(H["a"])().mark((function n(){return Object(H["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t.instant_save){n.next=6;break}return n.next=3,t.saveFile(e);case 3:Object(ce["f"])(e),n.next=8;break;case 6:t.tableData.push(e),t.$notify.success({title:"解锁成功",message:"成功解锁 "+e.title,duration:3e3});case 8:case"end":return n.stop()}}),n)})))()},showFail:function(e,t){console.error(e,t),window.viewSolutions||(window.viewSolutions=function(){window.parent.postMessage({op:"toFqa",index:2},"*")}),this.$notify.error({title:"转码失败",message:t+'转码失败，参考<a href="JavaScript:window.viewSolutions()">查看解决方案</a>',dangerouslyUseHTMLString:!0,duration:6e3})},changePlaying:function(e){this.playing_url=e,this.playing_auto=!0},handleDeleteAll:function(){this.tableData.forEach((function(e){Object(ce["f"])(e)})),this.tableData=[]},handleDecryptionConfig:function(){this.showConfigDialog=!0},handleDownloadAll:function(){var e=this,t=0,n=setInterval((function(){t<e.tableData.length?(e.saveFile(e.tableData[t]),t++):clearInterval(n)}),300)},saveFile:function(e){var t=this;return Object(K["a"])(Object(H["a"])().mark((function n(){return Object(H["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t.dir){n.next=6;break}return n.next=3,Object(ce["b"])(e,t.filename_policy,t.dir);case 3:t.$notify({title:"保存成功",message:e.title,position:"top-left",type:"success",duration:3e3}),n.next=7;break;case 6:Object(ce["c"])(e,t.filename_policy);case 7:case"end":return n.stop()}}),n)})))()},showDirectlySave:function(){var e=this;return Object(K["a"])(Object(H["a"])().mark((function t(){var n;return Object(H["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(window.showDirectoryPicker){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,e.$confirm("您的浏览器支持文件直接保存到磁盘，是否使用？","新特性提示",{confirmButtonText:"使用",cancelButtonText:"不使用",type:"warning",center:!0});case 5:t.next=11;break;case 7:return t.prev=7,t.t0=t["catch"](2),console.log(t.t0),t.abrupt("return");case 11:return t.prev=11,t.next=14,window.showDirectoryPicker();case 14:return e.dir=t.sent,n="__unlock_music_write_test.txt",t.next=18,e.dir.getFileHandle(n,{create:!0});case 18:return t.next=20,e.dir.removeEntry(n);case 20:t.next=25;break;case 22:t.prev=22,t.t1=t["catch"](11),console.error(t.t1);case 25:case"end":return t.stop()}}),t,null,[[2,7],[11,22]])})))()}}},Ee=Me,De=(n("4e96"),Object(ne["a"])(Ee,he,be,!1,null,"42fc3560",null)),Pe=De.exports,Ie=n("97e5"),Ce={name:"app",components:{FileSelector:ie,PreviewTable:fe,Home:Pe},data:function(){return{version:de.version}},created:function(){var e=this;this.$nextTick((function(){function t(){try{var e=document.body.scrollHeight,t=document.documentElement.scrollHeight,n=Math.min(e,t);window.parent.postMessage({op:"setIframeHeight",data:n},"*")}catch(r){}}e.finishLoad(),window.onresize=function(){t()},window.setInterval(t,1e3)}))},methods:{finishLoad:function(){var e=this;return Object(K["a"])(Object(H["a"])().mark((function t(){var n,r;return Object(H["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=document.getElementById("loader-mask"),n&&n.remove(),t.prev=2,t.next=5,Object(Ie["a"])(e.version);case 5:r=t.sent,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](2),console.warn("check version info failed",t.t0);case 11:delete r.URL,console.log(r);case 13:case"end":return t.stop()}}),t,null,[[2,8]])})))()}}},Ne=Ce,Be=(n("8bb9"),Object(ne["a"])(Ne,W,Z,!1,null,null,null)),Le=Be.exports,qe=n("fb74");"https:"===window.location.protocol&&Object(qe["a"])("".concat("","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available."),window.location.reload()},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}}),G["default"].use(V.a),G["default"].use($.a),G["default"].use(z.a),G["default"].use(R.a),G["default"].use(L.a),G["default"].use(N.a),G["default"].use(I.a),G["default"].use(D.a),G["default"].use(M.a),G["default"].use(T.a),G["default"].use(U.a),G["default"].use(k.a),G["default"].use(j.a),G["default"].use(y.a),G["default"].use(g.a),G["default"].use(p.a),G["default"].use(b.a),G["default"].use(d.a),G["default"].use(l.a),G["default"].use(s.a),G["default"].prototype.$notify=o.a,G["default"].prototype.$messageBox=i.a,G["default"].prototype.$alert=i.a.alert,G["default"].prototype.$confirm=i.a.confirm,G["default"].config.productionTip=!1,new G["default"]({render:function(e){return e(Le)}}).$mount("#app")},cf00:function(e,t,n){"use strict";n("3b55")},d2eb:function(e,t,n){"use strict";var r=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"",visible:e.show,"custom-class":"um-config-dialog",center:""},on:{close:function(t){return e.cancel()}}},[t("p",{staticClass:"tips"},[e._v("该格式目前仅支持"),t("br"),e._v("QQ音乐PC端 19.51之前版本")]),t("p",{staticClass:"tips-red"},[e._v("版本降级后，需要重新下载歌曲>>转换")]),t("el-checkbox",{staticClass:"checkbox",model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("本次登录不再提示")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{staticClass:"ok-btn x-btn",attrs:{type:"",loading:e.saving},on:{click:function(t){return e.ok(1)}}},[e._v("我已安装")]),t("el-button",{staticClass:"ok-btn x-btn",attrs:{type:"",loading:e.saving},on:{click:function(t){return e.ok(2)}}},[e._v("前去下载")])],1)],1)},i=[],a=n("80f6"),o=n("fdd9"),c=(n("e291"),{components:{},data:function(){return{resolve:null,btnClickType:1,checked:!1,show:!1,saving:!1}},mounted:function(){return Object(o["a"])(Object(a["a"])().mark((function e(){var t;return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=localStorage.getItem("QQMusicNoTipsTime"),t&&(new Date).getTime()-new Date(t).getTime()>=6048e5&&(localStorage.setItem("QQMusicNoTipsTime",""),localStorage.setItem("QQMusicNoTips",""));case 2:case"end":return e.stop()}}),e)})))()},watch:{checked:function(e,t){e?(localStorage.setItem("QQMusicNoTipsTime","1"),localStorage.setItem("QQMusicNoTips",(new Date).getTime())):(localStorage.setItem("QQMusicNoTipsTime",""),localStorage.setItem("QQMusicNoTips",""))}},methods:{ok:function(e){this.show=!1,this.btnClickType=e,this.resolve&&this.resolve(this.btnClickType)},cancel:function(){var e=this;return Object(o["a"])(Object(a["a"])().mark((function t(){return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.ok(1);case 1:case"end":return t.stop()}}),t)})))()},open:function(){var e=this;return Object(o["a"])(Object(a["a"])().mark((function t(){return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){var n=localStorage.getItem("QQMusicNoTips");n?t(1):(e.resolve=t,e.show=!0)})));case 1:case"end":return t.stop()}}),t)})))()}}}),s=c,u=(n("cf00"),n("8619")),l=Object(u["a"])(s,r,i,!1,null,"0e2f6648",null);t["a"]=l.exports},efc0:function(e,t,n){"use strict";n("e291"),n("7ddc"),n("8c29"),n("33e9"),n("49c1"),n("5f96");var r=n("d9c4"),i=n("675e"),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.values=new Map,t}return Object(r["b"])(t,e),t.prototype.load=function(e,t){return Object(r["a"])(this,void 0,Promise,(function(){return Object(r["c"])(this,(function(n){return this.values.has(e)?[2,this.values.get(e)]:[2,t]}))}))},t.prototype.save=function(e,t){return Object(r["a"])(this,void 0,Promise,(function(){return Object(r["c"])(this,(function(n){return this.values.set(e,t),[2]}))}))},t.prototype.getAll=function(){return Object(r["a"])(this,void 0,Promise,(function(){var e;return Object(r["c"])(this,(function(t){return e={},this.values.forEach((function(t,n){var r;Object.assign(e,(r={},r[n]=t,r))})),[2,e]}))}))},t.prototype.setAll=function(e){return Object(r["a"])(this,void 0,Promise,(function(){var t,n,i,a,o;return Object(r["c"])(this,(function(r){for(t=0,n=Object.entries(e);t<n.length;t++)i=n[t],a=i[0],o=i[1],this.values.set(a,o);return[2]}))}))},t}(i["b"]);t["a"]=a},f7fd:function(e,t,n){"use strict";(function(e){var r=n("80f6"),i=n("fdd9"),a=(n("a8dc"),n("f07e"),n("f9f6"),n("6367"),n("de1c")),o=n("23d8"),c=n("2882"),s=n("507a"),u=n("73ec"),l=n("b7c7"),f=n("97e5"),d=n("abad"),h=n("d2eb"),b=Object(d["a"])(100);t["a"]={name:"FileSelector",components:{QQMusicDialog:h["a"]},data:function(){return{fileList:[],qqMusicDialog:null,overNum:null,baseUrl:"",id:"",isShowTip:!0,loading:!0,task_all:0,task_finished:0,localQueue:new u["a"],queue:new u["a"],parallel:!1}},computed:{progress_string:function(){return"".concat(this.task_finished,"/ ").concat(this.task_all)},progress_value:function(){var e=this.task_all?this.task_finished/this.task_all*100:0;return e<5?5:e},progress_show:function(){return this.task_all!==this.task_finished}},mounted:function(){var t=this;window.Worker&&"file:"!==window.location.protocol?(console.log("Using Worker Pool"),this.queue=Object(a["a"])((function(){return Object(o["a"])(new c["a"](e))}),navigator.hardwareConcurrency||1),this.parallel=!0):console.log("Using Queue in Main Thread"),window.addEventListener("message",(function(e){var n=e.data,r=n.type,i=n.data;"getBaseUrl"==r?(t.baseUrl=i.baseUrl,t.id=i.userId):"getOverNum"==r&&(t.overNum=i,setTimeout((function(){t.isShowTip=!1}),2e3))})),this.initData()},methods:{initData:function(){var e=this;window.parent.postMessage({op:"getBaseUrl"},"*"),window.parent.postMessage({op:"getOverNum"},"*"),setTimeout((function(){null!=e.overNum&&""!=e.baseUrl||e.initData()}),1e3)},tClick:function(){var e=this;return Object(i["a"])(Object(r["a"])().mark((function t(){var n,i;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(e.$alert),e.$alert("这是一段内容","标题名称",{confirmButtonText:"确定",callback:function(e){}}),console.log(e.$dialog),console.log(e.$loading),n=e.$loading.service(),t.next=7,Object(f["b"])("张三.mp3");case 7:i=t.sent,n.close(),"ok"==i.state?console.log("开始转换"):console.log(i.msg),console.log("tclick",i);case 11:case"end":return t.stop()}}),t)})))()},addFile:function(e,t){var n=this;return Object(i["a"])(Object(r["a"])().mark((function a(){var o,c,u,d;return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(o=e.name.toUpperCase(),!0===t||-1==o.indexOf(".MGG")&&-1==o.indexOf(".MFLAC")){a.next=14;break}return n.fileList.push(e),a.next=5,n.$refs.qqMusicDialog.open();case 5:if(c=a.sent,2!=c){a.next=11;break}return window.parent.postMessage({op:"toFqa",index:2},"*"),a.abrupt("return");case 11:for(u=0;u<n.fileList.length;u++)n.addFile(n.fileList[u],!0);return n.fileList=[],a.abrupt("return");case 14:if(null!=n.overNum&&""!=n.baseUrl){a.next=18;break}return initData(),n.$alert("正在初始化中，请初始化完毕之后再进行操作","系统提示",{confirmButtonText:"确定"}),a.abrupt("return");case 18:d=function(){n.queue.queue(Object(i["a"])(Object(r["a"])().mark((function t(){var i,a,o,c,u,d,h,m,p=arguments;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=p.length>0&&void 0!==p[0]?p[0]:s["a"],console.log("start handling",e.name),t.prev=2,n.parallel){t.next=7;break}return b.start(),t.next=7,b.wait();case 7:return t.t0=i,t.t1=e,t.next=11,l["a"].getAll();case 11:return t.t2=t.sent,t.next=14,(0,t.t0)(t.t1,t.t2);case 14:return a=t.sent,t.next=17,Object(f["b"])(e.name,n.baseUrl,n.id);case 17:if(o=t.sent,"ok"==o.state){t.next=26;break}if("转换失败"!=o.msg){t.next=22;break}throw new Error(o.msg);case 22:return window.parent.postMessage({op:"toVip",res:o},"*"),t.abrupt("return");case 26:c=o.data,u=c.vipName,d=c.cNum,h=c.uNum,m=c.overNum,n.$emit("success",a),console.log(n.task_all,n.task_finished),n.task_all==n.task_finished+1&&window.parent.postMessage({op:"toIframeBottom",res:o},"*"),window.parent.postMessage({op:"showNum",vipName:u,cNum:d,uNum:h,res:o},"*"),n.overNum=m,n.overNum=n.overNum<0?0:n.overNum;case 33:t.next=39;break;case 35:t.prev=35,t.t3=t["catch"](2),console.error(t.t3),n.$emit("error",t.t3,e.name);case 39:return t.prev=39,n.task_finished++,t.finish(39);case 42:case"end":return t.stop()}}),t,null,[[2,35,39,42]])}))))},n.task_all++,n.parallel?n.localQueue.queue(Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return b.start(),e.next=3,b.wait();case 3:d();case 4:case"end":return e.stop()}}),e)})))):d();case 21:case"end":return a.stop()}}),a)})))()}}}}).call(this,n("bcc1"))},fa01:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));n("6367"),n("60d5"),n("e291"),n("d65e"),n("2299"),n("0533"),n("10dd"),n("9174"),n("997c"),n("d5e4"),n("5247"),n("8ef3"),n("9037"),n("f980"),n("b4d6"),n("35cf"),n("b5f6"),n("b233"),n("cbd8"),n("1a5f"),n("282e"),n("32b3"),n("63dc"),n("cf74"),n("949b"),n("03e8"),n("98e1"),n("9c17"),n("7646"),n("796c"),n("3df6"),n("b63f"),n("f726"),n("83ea");var r=n("08fe"),i=2,a=7;function o(t){var n=new TextDecoder,r=e.from(n.decode(t),"base64"),i=r.length;if(i<16)throw Error("key length is too short");for(var a=c(106,8),o=new Uint8Array(16),u=0;u<8;u++)o[u<<1]=a[u],o[1+(u<<1)]=r[u];var l=s(r.subarray(8),o);return r.set(l,8),r.subarray(0,8+l.length)}function c(e,t){for(var n=[],r=0;r<t;r++){var i=Math.tan(e+.1*r);n[r]=255&100*Math.abs(i)}return n}function s(e,t){if(e.length%8!=0)throw Error("inBuf size not a multiple of the block size");if(e.length<16)throw Error("inBuf size too small");var n=new r["a"](t,32),o=new Uint8Array(8),c=new DataView(o.buffer);n.decrypt(c,new DataView(e.buffer,e.byteOffset,8));for(var s=7&o[0],u=e.length-1-s-i-a,l=new Uint8Array(u),f=new Uint8Array(8),d=e.slice(0,8),h=8,b=1+s,m=function(){f=d,d=e.slice(h,h+8);for(var t=0;t<8;t++)o[t]^=d[t];n.decrypt(c,c),h+=8,b=0},p=1;p<=i;)b<8?(b++,p++):m();var v=0;while(v<u)b<8?(l[v]=o[b]^f[b],v++,b++):m();for(p=1;p<=a;p++)if(o[b]!=f[b])throw Error("zero check failed");return l}}).call(this,n("257d").Buffer)}});